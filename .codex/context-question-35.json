{
  "timestamp": "2025-12-09T09:25:34Z",
  "question": "正常模式 get 文件夹如何实现？协议与路径要求是什么？",
  "why": "需要确认是否可复用现有 socket Client 直接下载目录到本地 Log。",
  "findings": {
    "server_protocol": "docs/server.c 实现 run/get/exit/power 命令，全部使用 4 字节大端长度前缀传输控制消息。",
    "get_flow": "客户端发送文本命令 \"get <path>\"；服务器返回长度前缀消息 D_START/D_END/FILE 结构，其中 FILE 后跟原始文件字节流（无长度前缀，按文件大小流式发送）。支持递归目录。",
    "client_support": "gui/socket_client.py 的 Client.get_file() 完全匹配该协议，支持目录映射到本地并返回保存路径列表，可指定 dest_root。",
    "risk": "foup_acquisition 的 _recv_message 循环仅适用于前缀文本，不可直接复用来收取 get 文件流，需要单独走 Client.get_file 或独立连接。"
  }
}
