{
  "timestamp": "2025-11-26T15:03:30+08:00",
  "taskScope": "Config 页 FOUP 实时曲线：采集重启后清除旧数据；图表保持固定窗口并丢弃最旧点",
  "locations": {
    "foupAcquisition": {
      "file": "src/voc_app/gui/foup_acquisition.py",
      "role": "负责 TCP 采集线程，start/stop 控制 power on/off，使用 dataPointReceived 信号向 SeriesTableModel 追加点",
      "notes": "_sample_index 每次启动置 0；当前未重置 SeriesTableModel，导致二次启动复用旧点"
    },
    "seriesModel": {
      "file": "src/voc_app/gui/csv_model.py",
      "role": "SeriesTableModel append_point 支持固定 max_rows，满额时弹出首行；提供 bounds 给 ChartView",
      "notes": "缺少清空/重置接口，max_rows 在 FOUP 初始化为 600"
    },
    "appBootstrap": {
      "file": "src/voc_app/gui/app.py",
      "role": "创建 chartListModel 与 SeriesTableModel；FOUP 通道用 max_rows=600，并注入 foupAcquisition/context",
      "notes": "Config/Status 视图通过 chartEntry(index) 获取系列" 
    },
    "chartView": {
      "file": "src/voc_app/gui/qml/components/ChartCard.qml",
      "role": "ChartView + VXYModelMapper，使用 seriesModel bounds 更新坐标窗口，visibleWindow 取 maxRows",
      "notes": "轴范围按 min/max 动态计算；需要在清空数据后重置 axis/bounds"
    },
    "configView": {
      "file": "src/voc_app/gui/qml/views/ConfigView.qml",
      "role": "FOUP 子页面展示 ChartCard，按钮在 commands/Config_foupCommands.qml 控制 start/stop",
      "notes": "界面依赖 seriesModel.hasData 更新轴范围"
    }
  },
  "techStack": {
    "python": "PySide6 QObject + threading + socket；SeriesTableModel QAbstractTableModel with append_point",
    "qml": "QtQuick + QtCharts ChartView，VXYModelMapper 绑定 seriesModel",
    "dataFlow": "Socket -> FoupAcquisitionController -> SeriesTableModel.append_point -> ChartCard"
  },
  "tests": {
    "unit": {
      "command": "PYTHONPATH=src python3 -m unittest tests/test_serial_device.py",
      "status": "previously pass (2025-11-25); 当前未跑"
    },
    "gui": {
      "status": "未跑；PySide6/显示依赖"
    }
  },
  "observationReport": {
    "gaps": [
      "再次 start 后未清空 SeriesTableModel，旧点残留且 x 重新从 1，导致曲线重复叠加",
      "滑动窗口行为依赖 max_rows 但缺少主动重置，轴在清空后可能不刷新",
      "无测试覆盖 GUI 采集重启与窗口裁剪逻辑"
    ],
    "nextSteps": [
      "为 SeriesTableModel 提供 clear/reset，并在 start 时调用",
      "确保 ChartCard 在清空后重置轴范围",
      "验证 append_point 溢出时持续弹出左侧点，保持固定窗口"
    ]
  }
}
